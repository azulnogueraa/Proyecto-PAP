Found 7378 images belonging to 6 classes.
Found 1847 images belonging to 6 classes.
Found 2309 images belonging to 6 classes.
Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/mobilenet_v2/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_1.0_224_no_top.h5
9406464/9406464 [==============================] - 0s 0us/step
WARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.
WARNING:absl:There is a known slowdown when using v2.11+ Keras optimizers on M1/M2 Macs. Falling back to the legacy Keras optimizer, i.e., `tf.keras.optimizers.legacy.Adam`.
Epoch 1/20
231/231 [==============================] - ETA: 0s - loss: 0.9296 - accuracy: 0.6720
Epoch 1: val_loss improved from inf to 0.71137, saving model to best_model_mobilenet.h5
/Users/achula/miniconda3/envs/td8/lib/python3.8/site-packages/keras/src/engine/training.py:3000: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
231/231 [==============================] - 104s 440ms/step - loss: 0.9296 - accuracy: 0.6720 - val_loss: 0.7114 - val_accuracy: 0.7466 - lr: 1.0000e-04
Epoch 2/20
231/231 [==============================] - ETA: 0s - loss: 0.6818 - accuracy: 0.7529
Epoch 2: val_loss improved from 0.71137 to 0.64770, saving model to best_model_mobilenet.h5
231/231 [==============================] - 87s 377ms/step - loss: 0.6818 - accuracy: 0.7529 - val_loss: 0.6477 - val_accuracy: 0.7656 - lr: 1.0000e-04
Epoch 3/20
231/231 [==============================] - ETA: 0s - loss: 0.5774 - accuracy: 0.7940
Epoch 3: val_loss improved from 0.64770 to 0.61908, saving model to best_model_mobilenet.h5
231/231 [==============================] - 86s 370ms/step - loss: 0.5774 - accuracy: 0.7940 - val_loss: 0.6191 - val_accuracy: 0.7786 - lr: 1.0000e-04
Epoch 4/20
231/231 [==============================] - ETA: 0s - loss: 0.5108 - accuracy: 0.8165
Epoch 4: val_loss improved from 0.61908 to 0.59473, saving model to best_model_mobilenet.h5
231/231 [==============================] - 86s 372ms/step - loss: 0.5108 - accuracy: 0.8165 - val_loss: 0.5947 - val_accuracy: 0.7926 - lr: 1.0000e-04
Epoch 5/20
231/231 [==============================] - ETA: 0s - loss: 0.4312 - accuracy: 0.8429
Epoch 5: val_loss improved from 0.59473 to 0.58004, saving model to best_model_mobilenet.h5
231/231 [==============================] - 85s 368ms/step - loss: 0.4312 - accuracy: 0.8429 - val_loss: 0.5800 - val_accuracy: 0.7921 - lr: 1.0000e-04
Epoch 6/20
231/231 [==============================] - ETA: 0s - loss: 0.3885 - accuracy: 0.8574
Epoch 6: val_loss did not improve from 0.58004
231/231 [==============================] - 86s 371ms/step - loss: 0.3885 - accuracy: 0.8574 - val_loss: 0.6195 - val_accuracy: 0.7883 - lr: 1.0000e-04
Epoch 7/20
231/231 [==============================] - ETA: 0s - loss: 0.3315 - accuracy: 0.8776
Epoch 7: val_loss did not improve from 0.58004
231/231 [==============================] - 86s 371ms/step - loss: 0.3315 - accuracy: 0.8776 - val_loss: 0.6279 - val_accuracy: 0.7921 - lr: 1.0000e-04
Epoch 8/20
231/231 [==============================] - ETA: 0s - loss: 0.2757 - accuracy: 0.8958
Epoch 8: val_loss did not improve from 0.58004
231/231 [==============================] - 85s 366ms/step - loss: 0.2757 - accuracy: 0.8958 - val_loss: 0.6283 - val_accuracy: 0.8013 - lr: 1.0000e-04
Epoch 9/20
231/231 [==============================] - ETA: 0s - loss: 0.2376 - accuracy: 0.9105
Epoch 9: val_loss did not improve from 0.58004
231/231 [==============================] - 95s 410ms/step - loss: 0.2376 - accuracy: 0.9105 - val_loss: 0.6298 - val_accuracy: 0.8067 - lr: 1.0000e-04
Epoch 10/20
231/231 [==============================] - ETA: 0s - loss: 0.2242 - accuracy: 0.9187
Epoch 10: ReduceLROnPlateau reducing learning rate to 1.9999999494757503e-05.

Epoch 10: val_loss did not improve from 0.58004
231/231 [==============================] - 94s 406ms/step - loss: 0.2242 - accuracy: 0.9187 - val_loss: 0.6670 - val_accuracy: 0.8127 - lr: 1.0000e-04
Epoch 11/20
231/231 [==============================] - ETA: 0s - loss: 0.1550 - accuracy: 0.9484
Epoch 11: val_loss did not improve from 0.58004
231/231 [==============================] - 94s 406ms/step - loss: 0.1550 - accuracy: 0.9484 - val_loss: 0.6592 - val_accuracy: 0.8154 - lr: 2.0000e-05
Epoch 12/20
231/231 [==============================] - ETA: 0s - loss: 0.1273 - accuracy: 0.9572
Epoch 12: val_loss did not improve from 0.58004
231/231 [==============================] - 95s 409ms/step - loss: 0.1273 - accuracy: 0.9572 - val_loss: 0.6681 - val_accuracy: 0.8165 - lr: 2.0000e-05
Epoch 13/20
231/231 [==============================] - ETA: 0s - loss: 0.1191 - accuracy: 0.9620
Epoch 13: val_loss did not improve from 0.58004
231/231 [==============================] - 91s 393ms/step - loss: 0.1191 - accuracy: 0.9620 - val_loss: 0.6872 - val_accuracy: 0.8186 - lr: 2.0000e-05
Epoch 14/20
231/231 [==============================] - ETA: 0s - loss: 0.1050 - accuracy: 0.9642
Epoch 14: val_loss did not improve from 0.58004
231/231 [==============================] - 87s 376ms/step - loss: 0.1050 - accuracy: 0.9642 - val_loss: 0.7092 - val_accuracy: 0.8132 - lr: 2.0000e-05
Epoch 15/20
231/231 [==============================] - ETA: 0s - loss: 0.0889 - accuracy: 0.9694
Epoch 15: ReduceLROnPlateau reducing learning rate to 3.999999898951501e-06.

Epoch 15: val_loss did not improve from 0.58004
231/231 [==============================] - 86s 372ms/step - loss: 0.0889 - accuracy: 0.9694 - val_loss: 0.7217 - val_accuracy: 0.8121 - lr: 2.0000e-05
73/73 [==============================] - 17s 226ms/step - loss: 2.3708 - accuracy: 0.5102
Precisi√≥n en el conjunto de prueba: 0.5102
