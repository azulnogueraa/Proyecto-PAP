Found 7378 images belonging to 6 classes.
Found 1847 images belonging to 6 classes.
Found 2309 images belonging to 6 classes.
WARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.
WARNING:absl:There is a known slowdown when using v2.11+ Keras optimizers on M1/M2 Macs. Falling back to the legacy Keras optimizer, i.e., `tf.keras.optimizers.legacy.Adam`.
[34m[1mwandb[0m: [33mWARNING[0m WandbCallback is deprecated and will be removed in a future release. Please use the WandbMetricsLogger, WandbModelCheckpoint, and WandbEvalCallback callbacks instead. See https://docs.wandb.ai/guides/integrations/keras for more information.
Epoch 1/20
231/231 [==============================] - ETA: 0s - loss: 0.7778 - accuracy: 0.7173
Epoch 1: val_loss improved from inf to 0.55970, saving model to best_model_inception.h5
/Users/achula/miniconda3/envs/td8/lib/python3.8/site-packages/keras/src/engine/training.py:3000: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
231/231 [==============================] - 685s 3s/step - loss: 0.7778 - accuracy: 0.7173 - val_loss: 0.5597 - val_accuracy: 0.7943 - lr: 1.0000e-04
Epoch 2/20
231/231 [==============================] - ETA: 0s - loss: 0.4979 - accuracy: 0.8218
Epoch 2: val_loss improved from 0.55970 to 0.51191, saving model to best_model_inception.h5
231/231 [==============================] - 750s 3s/step - loss: 0.4979 - accuracy: 0.8218 - val_loss: 0.5119 - val_accuracy: 0.8121 - lr: 1.0000e-04
Epoch 3/20
231/231 [==============================] - ETA: 0s - loss: 0.3635 - accuracy: 0.8706
Epoch 3: val_loss improved from 0.51191 to 0.47296, saving model to best_model_inception.h5
231/231 [==============================] - 718s 3s/step - loss: 0.3635 - accuracy: 0.8706 - val_loss: 0.4730 - val_accuracy: 0.8349 - lr: 1.0000e-04
Epoch 4/20
231/231 [==============================] - ETA: 0s - loss: 0.3051 - accuracy: 0.8899
Epoch 4: val_loss did not improve from 0.47296
231/231 [==============================] - 791s 3s/step - loss: 0.3051 - accuracy: 0.8899 - val_loss: 0.4759 - val_accuracy: 0.8289 - lr: 1.0000e-04
Epoch 5/20
231/231 [==============================] - ETA: 0s - loss: 0.2202 - accuracy: 0.9203
Epoch 5: val_loss did not improve from 0.47296
231/231 [==============================] - 693s 3s/step - loss: 0.2202 - accuracy: 0.9203 - val_loss: 0.4837 - val_accuracy: 0.8397 - lr: 1.0000e-04
Epoch 6/20
231/231 [==============================] - ETA: 0s - loss: 0.1744 - accuracy: 0.9398
Epoch 6: val_loss did not improve from 0.47296
231/231 [==============================] - 699s 3s/step - loss: 0.1744 - accuracy: 0.9398 - val_loss: 0.5287 - val_accuracy: 0.8403 - lr: 1.0000e-04
Epoch 7/20
231/231 [==============================] - ETA: 0s - loss: 0.1542 - accuracy: 0.9488
Epoch 7: val_loss did not improve from 0.47296
231/231 [==============================] - 816s 4s/step - loss: 0.1542 - accuracy: 0.9488 - val_loss: 0.5286 - val_accuracy: 0.8430 - lr: 1.0000e-04
Epoch 8/20
231/231 [==============================] - ETA: 0s - loss: 0.1134 - accuracy: 0.9625
Epoch 8: ReduceLROnPlateau reducing learning rate to 1.9999999494757503e-05.

Epoch 8: val_loss did not improve from 0.47296
231/231 [==============================] - 867s 4s/step - loss: 0.1134 - accuracy: 0.9625 - val_loss: 0.5556 - val_accuracy: 0.8549 - lr: 1.0000e-04
Epoch 9/20
231/231 [==============================] - ETA: 0s - loss: 0.0558 - accuracy: 0.9817
Epoch 9: val_loss did not improve from 0.47296
231/231 [==============================] - 855s 4s/step - loss: 0.0558 - accuracy: 0.9817 - val_loss: 0.5426 - val_accuracy: 0.8560 - lr: 2.0000e-05
Epoch 10/20
231/231 [==============================] - ETA: 0s - loss: 0.0371 - accuracy: 0.9873
Epoch 10: val_loss did not improve from 0.47296
231/231 [==============================] - 816s 4s/step - loss: 0.0371 - accuracy: 0.9873 - val_loss: 0.5068 - val_accuracy: 0.8674 - lr: 2.0000e-05
Epoch 11/20
231/231 [==============================] - ETA: 0s - loss: 0.0240 - accuracy: 0.9928
Epoch 11: val_loss did not improve from 0.47296
231/231 [==============================] - 816s 4s/step - loss: 0.0240 - accuracy: 0.9928 - val_loss: 0.5603 - val_accuracy: 0.8625 - lr: 2.0000e-05
Epoch 12/20
231/231 [==============================] - ETA: 0s - loss: 0.0225 - accuracy: 0.9936
Epoch 12: val_loss did not improve from 0.47296
231/231 [==============================] - 816s 4s/step - loss: 0.0225 - accuracy: 0.9936 - val_loss: 0.5479 - val_accuracy: 0.8684 - lr: 2.0000e-05
Epoch 13/20
231/231 [==============================] - ETA: 0s - loss: 0.0165 - accuracy: 0.9955
Epoch 13: ReduceLROnPlateau reducing learning rate to 3.999999898951501e-06.

Epoch 13: val_loss did not improve from 0.47296
231/231 [==============================] - 810s 4s/step - loss: 0.0165 - accuracy: 0.9955 - val_loss: 0.5991 - val_accuracy: 0.8695 - lr: 2.0000e-05
73/73 [==============================] - 99s 1s/step - loss: 2.7641 - accuracy: 0.4894
Precisi√≥n en el conjunto de prueba: 0.4894
