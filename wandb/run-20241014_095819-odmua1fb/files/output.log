Found 8097 images belonging to 6 classes.
Found 1847 images belonging to 6 classes.
Found 2309 images belonging to 6 classes.
WARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.
WARNING:absl:There is a known slowdown when using v2.11+ Keras optimizers on M1/M2 Macs. Falling back to the legacy Keras optimizer, i.e., `tf.keras.optimizers.legacy.Adam`.
[34m[1mwandb[0m: [33mWARNING[0m WandbCallback is deprecated and will be removed in a future release. Please use the WandbMetricsLogger, WandbModelCheckpoint, and WandbEvalCallback callbacks instead. See https://docs.wandb.ai/guides/integrations/keras for more information.
Epoch 1/20
254/254 [==============================] - ETA: 0s - loss: 0.8885 - accuracy: 0.6754
Epoch 1: val_loss improved from inf to 0.63242, saving model to best_model_xception.h5
/Users/achula/miniconda3/envs/td8/lib/python3.8/site-packages/keras/src/engine/training.py:3000: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
254/254 [==============================] - 913s 4s/step - loss: 0.8885 - accuracy: 0.6754 - val_loss: 0.6324 - val_accuracy: 0.7683 - lr: 1.0000e-04
Epoch 2/20
254/254 [==============================] - ETA: 0s - loss: 0.5736 - accuracy: 0.7886
Epoch 2: val_loss improved from 0.63242 to 0.56733, saving model to best_model_xception.h5
254/254 [==============================] - 988s 4s/step - loss: 0.5736 - accuracy: 0.7886 - val_loss: 0.5673 - val_accuracy: 0.7916 - lr: 1.0000e-04
Epoch 3/20
254/254 [==============================] - ETA: 0s - loss: 0.4546 - accuracy: 0.8348
Epoch 3: val_loss improved from 0.56733 to 0.51964, saving model to best_model_xception.h5
254/254 [==============================] - 882s 3s/step - loss: 0.4546 - accuracy: 0.8348 - val_loss: 0.5196 - val_accuracy: 0.8110 - lr: 1.0000e-04
Epoch 4/20
254/254 [==============================] - ETA: 0s - loss: 0.3422 - accuracy: 0.8756
Epoch 4: val_loss improved from 0.51964 to 0.51539, saving model to best_model_xception.h5
254/254 [==============================] - 875s 3s/step - loss: 0.3422 - accuracy: 0.8756 - val_loss: 0.5154 - val_accuracy: 0.8073 - lr: 1.0000e-04
Epoch 5/20
254/254 [==============================] - ETA: 0s - loss: 0.2557 - accuracy: 0.9072
Epoch 5: val_loss did not improve from 0.51539
254/254 [==============================] - 895s 4s/step - loss: 0.2557 - accuracy: 0.9072 - val_loss: 0.5424 - val_accuracy: 0.8045 - lr: 1.0000e-04
Epoch 6/20
254/254 [==============================] - ETA: 0s - loss: 0.1888 - accuracy: 0.9336
Epoch 6: val_loss did not improve from 0.51539
254/254 [==============================] - 853s 3s/step - loss: 0.1888 - accuracy: 0.9336 - val_loss: 0.5653 - val_accuracy: 0.8110 - lr: 1.0000e-04
Epoch 7/20
254/254 [==============================] - ETA: 0s - loss: 0.1493 - accuracy: 0.9481
Epoch 7: val_loss did not improve from 0.51539
254/254 [==============================] - 846s 3s/step - loss: 0.1493 - accuracy: 0.9481 - val_loss: 0.5725 - val_accuracy: 0.8186 - lr: 1.0000e-04
Epoch 8/20
254/254 [==============================] - ETA: 0s - loss: 0.1144 - accuracy: 0.9590
Epoch 8: val_loss did not improve from 0.51539
254/254 [==============================] - 865s 3s/step - loss: 0.1144 - accuracy: 0.9590 - val_loss: 0.6211 - val_accuracy: 0.8100 - lr: 1.0000e-04
Epoch 9/20
254/254 [==============================] - ETA: 0s - loss: 0.0929 - accuracy: 0.9690
Epoch 9: ReduceLROnPlateau reducing learning rate to 1.9999999494757503e-05.

Epoch 9: val_loss did not improve from 0.51539
254/254 [==============================] - 853s 3s/step - loss: 0.0929 - accuracy: 0.9690 - val_loss: 0.6442 - val_accuracy: 0.8192 - lr: 1.0000e-04
Epoch 10/20
254/254 [==============================] - ETA: 0s - loss: 0.0599 - accuracy: 0.9827
Epoch 10: val_loss did not improve from 0.51539
254/254 [==============================] - 853s 3s/step - loss: 0.0599 - accuracy: 0.9827 - val_loss: 0.6444 - val_accuracy: 0.8278 - lr: 2.0000e-05
Epoch 11/20
254/254 [==============================] - ETA: 0s - loss: 0.0468 - accuracy: 0.9868
Epoch 11: val_loss did not improve from 0.51539
254/254 [==============================] - 871s 3s/step - loss: 0.0468 - accuracy: 0.9868 - val_loss: 0.6284 - val_accuracy: 0.8305 - lr: 2.0000e-05
Epoch 12/20
254/254 [==============================] - ETA: 0s - loss: 0.0411 - accuracy: 0.9879
Epoch 12: val_loss did not improve from 0.51539
254/254 [==============================] - 857s 3s/step - loss: 0.0411 - accuracy: 0.9879 - val_loss: 0.6973 - val_accuracy: 0.8219 - lr: 2.0000e-05
Epoch 13/20
254/254 [==============================] - ETA: 0s - loss: 0.0416 - accuracy: 0.9864
Epoch 13: val_loss did not improve from 0.51539
254/254 [==============================] - 930s 4s/step - loss: 0.0416 - accuracy: 0.9864 - val_loss: 0.6853 - val_accuracy: 0.8300 - lr: 2.0000e-05
Epoch 14/20
254/254 [==============================] - ETA: 0s - loss: 0.0352 - accuracy: 0.9905
Epoch 14: ReduceLROnPlateau reducing learning rate to 3.999999898951501e-06.

Epoch 14: val_loss did not improve from 0.51539
254/254 [==============================] - 1009s 4s/step - loss: 0.0352 - accuracy: 0.9905 - val_loss: 0.6814 - val_accuracy: 0.8305 - lr: 2.0000e-05
73/73 [==============================] - 153s 2s/step - loss: 1.8994 - accuracy: 0.5175
Precisi√≥n en el conjunto de prueba: 0.5175
